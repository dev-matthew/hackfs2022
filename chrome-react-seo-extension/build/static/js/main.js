!function(e){function t(t){for(var n,c,l=t[0],i=t[1],r=t[2],u=0,p=[];u<l.length;u++)c=l[u],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&p.push(a[c][0]),a[c]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);for(d&&d(t);p.length;)p.shift()();return o.push.apply(o,r||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],n=!0,l=1;l<s.length;l++){var i=s[l];0!==a[i]&&(n=!1)}n&&(o.splice(t--,1),e=c(c.s=s[0]))}return e}var n={},a={2:0},o=[];function c(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.m=e,c.c=n,c.d=function(e,t,s){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(s,n,function(t){return e[t]}.bind(null,n));return s},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var l=this["webpackJsonpchrome-react-seo-extension"]=this["webpackJsonpchrome-react-seo-extension"]||[],i=l.push.bind(l);l.push=t,l=l.slice();for(var r=0;r<l.length;r++)t(l[r]);var d=i;o.push([355,0,3]),s()}({120:function(e,t){},189:function(e,t){},190:function(e,t){},191:function(e,t){},213:function(e,t){},214:function(e,t){},225:function(e,t){},226:function(e,t){},246:function(e,t){},248:function(e,t){},249:function(e,t){},250:function(e,t){},251:function(e,t){},259:function(e,t){},265:function(e,t){},268:function(e,t){},287:function(e,t){},316:function(e,t){},321:function(e,t){},325:function(e,t){},329:function(e,t){},355:function(e,t,s){e.exports=s(711)},362:function(e,t,s){},363:function(e,t,s){},711:function(e,t,s){"use strict";s.r(t);var n,a,o,c,l=s(32),i=s(342),r=s.n(i),d=(s(362),s(363),s(352)),u=s(202),p=s(78),j=s(137),f=s(12),g=[],m={all:[]};function v(){const[e,t]=Object(l.useState)(0),[s,i]=Object(l.useState)(null===localStorage.getItem("privateKey")),[r,v]=Object(l.useState)(null!==localStorage.getItem("privateKey")&&localStorage.getItem("privateKey").includes("cipher")),[b,y]=Object(l.useState)(0),[h,O]=Object(l.useState)(!1),[x,N]=Object(l.useState)(!1),[S,w]=Object(l.useState)(!1),[P,I]=Object(l.useState)(""),[C,M]=Object(l.useState)(""),[k,K]=Object(l.useState)(!1);async function E(e){if(""!==e)try{n=await p.a.fromEncryptedJson(localStorage.getItem("privateKey"),e,y)}catch(t){alert("Invalid password")}else n=new p.a(localStorage.getItem("privateKey"));console.log(n),L(),await T()}async function T(){c=n.address,a=await j.a.create(n),console.log(a),await async function(){let e=await a.conversations.list();for(const t of e)g.push(t);O(!0),console.log(g)}()}async function A(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all";try{""===s&&(s="all");let n=await a.conversations.newConversation(e);await n.send(s+"////"+t),console.log("Sent message "+t+" to "+e)}catch(n){alert("Address is not on the XMTP network yet")}}async function B(e){m={all:[]},console.log(e);let t=await async function(e){let t=await a.conversations.newConversation(e);return await t.messages()}(e.peerAddress);I(e.peerAddress),console.log(t);for(const s of t){let e,t,n,a=s.content.split("////");a.length>1?(e=a[0],t=a[1]):(e="all",t=a[0]),n=s.senderAddress===c?"Me - ":s.senderAddress.substring(0,6)+"..."+s.senderAddress.slice(-4)+" - ",e in m?m[e].push(n+t):m[e]=[n+t],"all"!==e&&m.all.push(n+t)}console.log(m),N(!1),N(!0)}function L(){v(!1),i(!1),t(0),y(0),K(!1)}return window.onload=function(){r||null===localStorage.getItem("privateKey")||E("")},Object(f.jsxs)("div",{className:"App",children:[s&&Object(f.jsxs)("div",{className:"Settings",children:[localStorage.getItem("privateKey")&&Object(f.jsx)(u.a,{className:"ClosePrivateKey Icon",onClick:()=>{L()}}),Object(f.jsx)("div",{className:"Progress",id:"PrivateKeyProgress",style:{width:500*b+"px"}}),Object(f.jsx)("input",{className:"SettingsInput",id:"PrivateKey",type:"text",autoComplete:"off",placeholder:"Private Key"}),Object(f.jsx)("input",{className:"SettingsInput",id:"Password",type:"text",autoComplete:"off",placeholder:"Password"}),Object(f.jsx)("button",{className:"Save SaveSettings",onClick:()=>{!async function(e,t){try{if(n=new p.a(e),t){let e=await n.encrypt(t,y);localStorage.setItem("privateKey",e)}else localStorage.setItem("privateKey",e);console.log(n),L(),await T()}catch(s){alert("Invalid private key")}}(document.getElementById("PrivateKey").value,document.getElementById("Password").value)},children:"Save"})]}),r&&Object(f.jsxs)("div",{className:"InitialPassword",children:[Object(f.jsx)("div",{className:"Progress",id:"PasswordProgress",style:{width:500*b+"px"}}),Object(f.jsx)("input",{className:"SettingsInput",id:"InitialPassword",type:"text",autoComplete:"off",placeholder:"Password"}),Object(f.jsx)("button",{className:"Save SavePassword",onClick:()=>{E(document.getElementById("InitialPassword").value)},children:"Enter"})]}),k&&Object(f.jsxs)("div",{className:"NewConversationPopup",children:[Object(f.jsx)(u.a,{className:"ClosePrivateKey Icon",onClick:()=>{L()}}),Object(f.jsx)("input",{className:"SettingsInput",id:"ToAddress",type:"text",autoComplete:"off",placeholder:"Message Recipient"}),Object(f.jsx)("input",{className:"SettingsInput",id:"ToWebsite",type:"text",autoComplete:"off",placeholder:"Website (Optional)"}),Object(f.jsx)("button",{className:"CurrentWebsite",onClick:()=>{chrome.tabs&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var t;document.getElementById("ToWebsite").value=(t=e[0].url,new URL(t).host)}))},children:"Current"}),Object(f.jsx)("input",{className:"SettingsInput",id:"ToMessage",type:"text",autoComplete:"off",placeholder:"Message"}),Object(f.jsx)("button",{className:"Save SendMessage",onClick:()=>{A(document.getElementById("ToAddress").value,document.getElementById("ToMessage").value,document.getElementById("ToWebsite").value),L()},children:"Send"})]}),Object(f.jsxs)("div",{className:"GlobalHeader",children:[Object(f.jsx)("span",{className:"MyAddress",title:c,children:c&&"Logged in as "+c.substring(0,6)+"..."+c.slice(-4)||"Loading..."}),Object(f.jsx)("div",{className:"NewConversation HeaderButton",onClick:()=>{K(!0)},children:"New Conversation"}),Object(f.jsx)(d.a,{className:"OpenSettings Icon",onClick:()=>{t(2),i(!0)},style:{color:2===e?"white":"rgba(255,255,255,0.5)"}})]}),Object(f.jsxs)("div",{className:"LeftNav",children:[Object(f.jsx)("div",{className:"LeftNavHeader",children:Object(f.jsx)("span",{className:"LeftNavHeaderOption",children:"People"})}),h?Object(f.jsx)("div",{children:g.map(((e,t)=>Object(f.jsx)("div",{className:"Option Person",onClick:()=>{B(e)},children:e.peerAddress.substring(0,6)+"..."+e.peerAddress.slice(-4)},t)))}):Object(f.jsx)("div",{className:"Option Person",children:"Loading..."})]}),Object(f.jsxs)("div",{className:"MiddleNav",children:[Object(f.jsx)("span",{className:"MiddleNavHeaderOption",children:"Sites"}),x&&Object(f.jsx)("div",{children:Object.keys(m).map(((e,t)=>Object(f.jsx)("div",{className:"Option Site",onClick:()=>{!async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";o=m[e],M(e),w(!1),w(!0)}(e)},children:e},t)))})]}),Object(f.jsxs)("div",{className:"RightNav",children:[Object(f.jsx)("div",{className:"RightNavHeader"}),Object(f.jsx)("div",{className:"Messages",children:S&&Object(f.jsx)("div",{children:o.map(((e,t)=>Object(f.jsx)("div",{className:e.includes("Me")?"Message Right":"Message Left",title:C,children:e},t)))})}),S&&Object(f.jsx)("input",{className:"TextMessage",type:"text",placeholder:"Type your message",autoComplete:"off",onKeyPress:e=>{if("Enter"===e.key){console.log(e.target.value),A(P,e.target.value,C);let t=document.createElement("div");t.classList.add("Message"),t.classList.add("Right"),t.innerHTML="Me - "+e.target.value,document.getElementsByClassName("Messages")[0].appendChild(t),document.getElementsByClassName("TextMessage")[0].value=""}}})]})]})}r.a.createRoot(document.getElementById("root")).render(Object(f.jsx)(v,{}))}});
//# sourceMappingURL=main.js.map